name: grazing-rotation-real
description: Pyrennial Farms - 5-paddock adaptive grazing system, Collinsville TX

# =============================================================================
# PYRENNIAL FARMS MODEL - Collinsville, TX
# =============================================================================
# 5 paddocks, 14 head (3 yearlings @ 400kg, 11 mature @ 600kg)
# Adaptive rotational grazing with electric wire subdivisions
#
# KEY IMPROVEMENT: Separate tracking of dormant vs active forage
# - Dormant = standing dead/brown grass (has mass, low nutrition, doesn't grow)
# - Active = green growing material (high nutrition, responds to conditions)
# - Cattle graze both, preferring active
# - Dormant has minimum floor (root mass never goes to zero)
# - In spring, dormant converts to active (greenup)
#
# Last updated: 2026-01-31
# Current paddock: Big Pasture (since Jan 22)
# =============================================================================

params:
  # ============================================================
  # HERD CHARACTERISTICS
  # ============================================================
  herd_count: 14
  yearlings: 3           # 400kg each
  mature_cattle: 11      # 600kg each
  total_herd_weight: 7800  # kg (3*400 + 11*600)
  daily_intake_rate: 0.025  # 2.5% of body weight per day

  # Paddock IDs: 1=CCE, 2=CCW, 3=Big, 4=Hog, 5=South (Frankie's)
  current_paddock: 3     # Big Pasture (since Jan 22, 2026)
  rotation_days: 14      # Default days per paddock

  # ============================================================
  # PADDOCK ACREAGE
  # ============================================================
  cce_acres: 8           # Cedar Crest East - hilltop, open
  ccw_acres: 8           # Cedar Crest West - silvopasture, trees
  big_acres: 9           # Big Pasture - flood plain, wooded
  hog_acres: 5           # Hog Pasture - creek access
  south_acres: 8         # Frankie's Pasture - creek runoff

  # ============================================================
  # FORAGE GROWTH PARAMETERS
  # ============================================================
  max_growth_rate: 80    # kg/acre/day at optimal conditions (summer peak)
  optimal_forage: 2500   # kg/acre total carrying capacity

  # Dormant forage parameters
  dormant_min: 300       # kg/acre - root mass floor, never goes below this
  dormant_decay_rate: 0.002  # Slow decay of standing dead material
  dormant_palatability: 0.4  # Cattle eat dormant at 40% the rate of active

  # ============================================================
  # SEASONAL ADJUSTMENTS
  # ============================================================
  # Current: Late January = deep winter dormancy
  season_multiplier: 0.1   # Growth at 10% of max

  # Greenup parameters (dormant -> active conversion)
  greenup_threshold: 0.3   # season_multiplier must exceed this for greenup
  greenup_rate: 0.02       # % of dormant converting to active per day when warm

  # ============================================================
  # WEATHER / MOISTURE (Collinsville, TX)
  # ============================================================
  base_rain_input: 3       # mm/day average
  base_evaporation: 4      # mm/day baseline

  # Paddock-specific evaporation multipliers
  cce_evap_mult: 1.3       # Open hilltop - high evaporation
  ccw_evap_mult: 0.9       # Silvopasture - tree shade
  big_evap_mult: 0.8       # Wooded flood plain
  hog_evap_mult: 0.7       # Creek + trees - lowest
  south_evap_mult: 0.85    # Creek runoff area

  # Flood plain water bonus
  big_flood_bonus: 0.5
  hog_flood_bonus: 0.3
  south_flood_bonus: 0.4

  field_capacity: 100      # mm maximum soil moisture
  moisture_optimal: 60     # mm for best growth

  # ============================================================
  # SOIL ORGANIC MATTER
  # ============================================================
  som_mineralization_rate: 0.0001
  manure_addition_rate: 0.00005
  som_growth_multiplier: 20

  # ============================================================
  # GRAZING DYNAMICS
  # ============================================================
  trampling_loss_rate: 0.3   # 30% trampled/wasted
  max_daily_consumption: 0.15  # Can't eat more than 15% of standing forage/day

# =============================================================================
# STOCKS - Current state as of Jan 31, 2026
# =============================================================================
# Based on rotation history:
# - CCE: Grazed Jan 3-17, HAY REQUIRED, stressed
# - CCW: Grazed Dec 24 - Jan 3, no hay, tree cover helped
# - Big: Currently grazed since Jan 22, hay supplementation
# - Hog: Short rotation Jan 17-22, creek moisture
# - Frankie's: Resting since Dec 24, seeded Dec 25, ~10-15% green near creek
# =============================================================================

stocks:
  # ============================================================
  # CEDAR CREST EAST (Hilltop, Open) - Stressed from drought
  # Grazed Jan 3-17, needed hay, brown/dormant
  # ============================================================
  cce_dormant:
    initial: 450
    min: 300           # Root mass floor
  cce_active:
    initial: 50        # Very little green
    min: 0
  cce_moisture:
    initial: 40        # Dry - hilltop, drought stress
  cce_som:
    initial: 3.2

  # ============================================================
  # CEDAR CREST WEST (Silvopasture) - Tree cover helped
  # Grazed Dec 24 - Jan 3, no hay needed
  # ============================================================
  ccw_dormant:
    initial: 900
    min: 300
  ccw_active:
    initial: 200       # Some green from tree protection
    min: 0
  ccw_moisture:
    initial: 55        # Better moisture from tree shade
  ccw_som:
    initial: 3.5

  # ============================================================
  # BIG PASTURE (Flood Plain) - Currently being grazed
  # Since Jan 22, hay supplementation ongoing
  # ============================================================
  big_dormant:
    initial: 600
    min: 300
  big_active:
    initial: 150
    min: 0
  big_moisture:
    initial: 70        # Flood plain holds water
  big_som:
    initial: 3.8

  # ============================================================
  # HOG PASTURE (Creek Access) - Recently grazed, recovering
  # Grazed Jan 17-22 (5 days), now resting 9 days
  # Calculation: ~1600 start - 255 grazed + 40 regrown = ~1385 total
  # ============================================================
  hog_dormant:
    initial: 850       # Some trampled to dormant during grazing
    min: 300
  hog_active:
    initial: 350       # Active grazed first, slow winter recovery
    min: 0
  hog_moisture:
    initial: 75        # Good - creek seepage, but some drawn down
  hog_som:
    initial: 4.0

  # ============================================================
  # FRANKIE'S PASTURE (Creek Runoff) - Resting, seeded
  # Resting since Dec 24 (38 days), seeded Dec 25
  # 10-15% showing green shoots near creek
  # ============================================================
  south_dormant:
    initial: 500
    min: 300
  south_active:
    initial: 100       # Seedlings emerging near creek
    min: 0
  south_moisture:
    initial: 65        # Good from creek runoff
  south_som:
    initial: 3.3

  # ============================================================
  # ROTATION TRACKING
  # ============================================================
  rotation_timer:
    initial: 9         # Days on Big Pasture (since Jan 22)

# =============================================================================
# FLOWS
# =============================================================================
# For each paddock:
# - Active growth: logistic growth based on moisture, SOM, season
# - Dormant decay: slow loss of standing dead material
# - Greenup: dormant -> active when season_multiplier > threshold
# - Grazing: consumes active first (preferred), then dormant
# - Trampling: fraction of grazing lost to waste
# =============================================================================

flows:
  # ============================================================
  # CEDAR CREST EAST
  # ============================================================
  cce_active_growth:
    from: external
    to: cce_active
    rate: "current_paddock == 1 ? 0 : max_growth_rate * season_multiplier * (cce_active / optimal_forage) * (1 - (cce_dormant + cce_active) / optimal_forage) * (cce_moisture / moisture_optimal) * (1 + cce_som * som_growth_multiplier / 100)"

  cce_greenup:
    from: cce_dormant
    to: cce_active
    rate: "season_multiplier > greenup_threshold ? cce_dormant * greenup_rate : 0"

  cce_dormant_decay:
    from: cce_dormant
    to: external
    rate: "max(0, (cce_dormant - dormant_min) * dormant_decay_rate)"

  cce_grazing_active:
    from: cce_active
    to: external
    rate: "current_paddock == 1 ? min((total_herd_weight * daily_intake_rate) / cce_acres, cce_active * max_daily_consumption) : 0"

  cce_grazing_dormant:
    from: cce_dormant
    to: external
    rate: "current_paddock == 1 ? min(max(0, (total_herd_weight * daily_intake_rate) / cce_acres - cce_grazing_active) * dormant_palatability, (cce_dormant - dormant_min) * max_daily_consumption) : 0"

  cce_trampling:
    from: cce_active
    to: cce_dormant
    rate: "(cce_grazing_active + cce_grazing_dormant) * trampling_loss_rate * 0.5"
    # Trampled material becomes dormant/dead

  cce_rain:
    from: external
    to: cce_moisture
    rate: base_rain_input

  cce_evapotranspiration:
    from: cce_moisture
    to: external
    rate: "base_evaporation * cce_evap_mult * (1 + (cce_dormant + cce_active) / optimal_forage * 0.3)"

  cce_deep_percolation:
    from: cce_moisture
    to: external
    rate: "max(0, cce_moisture - field_capacity) * 0.5"

  cce_som_loss:
    from: cce_som
    to: external
    rate: "cce_som * som_mineralization_rate"

  cce_manure:
    from: external
    to: cce_som
    rate: "(cce_grazing_active + cce_grazing_dormant) * manure_addition_rate"

  # ============================================================
  # CEDAR CREST WEST
  # ============================================================
  ccw_active_growth:
    from: external
    to: ccw_active
    rate: "current_paddock == 2 ? 0 : max_growth_rate * season_multiplier * (ccw_active / optimal_forage) * (1 - (ccw_dormant + ccw_active) / optimal_forage) * (ccw_moisture / moisture_optimal) * (1 + ccw_som * som_growth_multiplier / 100)"

  ccw_greenup:
    from: ccw_dormant
    to: ccw_active
    rate: "season_multiplier > greenup_threshold ? ccw_dormant * greenup_rate : 0"

  ccw_dormant_decay:
    from: ccw_dormant
    to: external
    rate: "max(0, (ccw_dormant - dormant_min) * dormant_decay_rate)"

  ccw_grazing_active:
    from: ccw_active
    to: external
    rate: "current_paddock == 2 ? min((total_herd_weight * daily_intake_rate) / ccw_acres, ccw_active * max_daily_consumption) : 0"

  ccw_grazing_dormant:
    from: ccw_dormant
    to: external
    rate: "current_paddock == 2 ? min(max(0, (total_herd_weight * daily_intake_rate) / ccw_acres - ccw_grazing_active) * dormant_palatability, (ccw_dormant - dormant_min) * max_daily_consumption) : 0"

  ccw_trampling:
    from: ccw_active
    to: ccw_dormant
    rate: "(ccw_grazing_active + ccw_grazing_dormant) * trampling_loss_rate * 0.5"

  ccw_rain:
    from: external
    to: ccw_moisture
    rate: base_rain_input

  ccw_evapotranspiration:
    from: ccw_moisture
    to: external
    rate: "base_evaporation * ccw_evap_mult * (1 + (ccw_dormant + ccw_active) / optimal_forage * 0.3)"

  ccw_deep_percolation:
    from: ccw_moisture
    to: external
    rate: "max(0, ccw_moisture - field_capacity) * 0.5"

  ccw_som_loss:
    from: ccw_som
    to: external
    rate: "ccw_som * som_mineralization_rate"

  ccw_manure:
    from: external
    to: ccw_som
    rate: "(ccw_grazing_active + ccw_grazing_dormant) * manure_addition_rate"

  # ============================================================
  # BIG PASTURE (Currently being grazed)
  # ============================================================
  big_active_growth:
    from: external
    to: big_active
    rate: "current_paddock == 3 ? 0 : max_growth_rate * season_multiplier * (big_active / optimal_forage) * (1 - (big_dormant + big_active) / optimal_forage) * (big_moisture / moisture_optimal) * (1 + big_som * som_growth_multiplier / 100)"

  big_greenup:
    from: big_dormant
    to: big_active
    rate: "season_multiplier > greenup_threshold ? big_dormant * greenup_rate : 0"

  big_dormant_decay:
    from: big_dormant
    to: external
    rate: "max(0, (big_dormant - dormant_min) * dormant_decay_rate)"

  big_grazing_active:
    from: big_active
    to: external
    rate: "current_paddock == 3 ? min((total_herd_weight * daily_intake_rate) / big_acres, big_active * max_daily_consumption) : 0"

  big_grazing_dormant:
    from: big_dormant
    to: external
    rate: "current_paddock == 3 ? min(max(0, (total_herd_weight * daily_intake_rate) / big_acres - big_grazing_active) * dormant_palatability, (big_dormant - dormant_min) * max_daily_consumption) : 0"

  big_trampling:
    from: big_active
    to: big_dormant
    rate: "(big_grazing_active + big_grazing_dormant) * trampling_loss_rate * 0.5"

  big_rain:
    from: external
    to: big_moisture
    rate: "base_rain_input + big_flood_bonus"

  big_evapotranspiration:
    from: big_moisture
    to: external
    rate: "base_evaporation * big_evap_mult * (1 + (big_dormant + big_active) / optimal_forage * 0.3)"

  big_deep_percolation:
    from: big_moisture
    to: external
    rate: "max(0, big_moisture - field_capacity) * 0.5"

  big_som_loss:
    from: big_som
    to: external
    rate: "big_som * som_mineralization_rate"

  big_manure:
    from: external
    to: big_som
    rate: "(big_grazing_active + big_grazing_dormant) * manure_addition_rate"

  # ============================================================
  # HOG PASTURE
  # ============================================================
  hog_active_growth:
    from: external
    to: hog_active
    rate: "current_paddock == 4 ? 0 : max_growth_rate * season_multiplier * (hog_active / optimal_forage) * (1 - (hog_dormant + hog_active) / optimal_forage) * (hog_moisture / moisture_optimal) * (1 + hog_som * som_growth_multiplier / 100)"

  hog_greenup:
    from: hog_dormant
    to: hog_active
    rate: "season_multiplier > greenup_threshold ? hog_dormant * greenup_rate : 0"

  hog_dormant_decay:
    from: hog_dormant
    to: external
    rate: "max(0, (hog_dormant - dormant_min) * dormant_decay_rate)"

  hog_grazing_active:
    from: hog_active
    to: external
    rate: "current_paddock == 4 ? min((total_herd_weight * daily_intake_rate) / hog_acres, hog_active * max_daily_consumption) : 0"

  hog_grazing_dormant:
    from: hog_dormant
    to: external
    rate: "current_paddock == 4 ? min(max(0, (total_herd_weight * daily_intake_rate) / hog_acres - hog_grazing_active) * dormant_palatability, (hog_dormant - dormant_min) * max_daily_consumption) : 0"

  hog_trampling:
    from: hog_active
    to: hog_dormant
    rate: "(hog_grazing_active + hog_grazing_dormant) * trampling_loss_rate * 0.5"

  hog_rain:
    from: external
    to: hog_moisture
    rate: "base_rain_input + hog_flood_bonus"

  hog_evapotranspiration:
    from: hog_moisture
    to: external
    rate: "base_evaporation * hog_evap_mult * (1 + (hog_dormant + hog_active) / optimal_forage * 0.3)"

  hog_deep_percolation:
    from: hog_moisture
    to: external
    rate: "max(0, hog_moisture - field_capacity) * 0.5"

  hog_som_loss:
    from: hog_som
    to: external
    rate: "hog_som * som_mineralization_rate"

  hog_manure:
    from: external
    to: hog_som
    rate: "(hog_grazing_active + hog_grazing_dormant) * manure_addition_rate"

  # ============================================================
  # FRANKIE'S PASTURE (South)
  # ============================================================
  south_active_growth:
    from: external
    to: south_active
    rate: "current_paddock == 5 ? 0 : max_growth_rate * season_multiplier * (south_active / optimal_forage) * (1 - (south_dormant + south_active) / optimal_forage) * (south_moisture / moisture_optimal) * (1 + south_som * som_growth_multiplier / 100)"

  south_greenup:
    from: south_dormant
    to: south_active
    rate: "season_multiplier > greenup_threshold ? south_dormant * greenup_rate : 0"

  south_dormant_decay:
    from: south_dormant
    to: external
    rate: "max(0, (south_dormant - dormant_min) * dormant_decay_rate)"

  south_grazing_active:
    from: south_active
    to: external
    rate: "current_paddock == 5 ? min((total_herd_weight * daily_intake_rate) / south_acres, south_active * max_daily_consumption) : 0"

  south_grazing_dormant:
    from: south_dormant
    to: external
    rate: "current_paddock == 5 ? min(max(0, (total_herd_weight * daily_intake_rate) / south_acres - south_grazing_active) * dormant_palatability, (south_dormant - dormant_min) * max_daily_consumption) : 0"

  south_trampling:
    from: south_active
    to: south_dormant
    rate: "(south_grazing_active + south_grazing_dormant) * trampling_loss_rate * 0.5"

  south_rain:
    from: external
    to: south_moisture
    rate: "base_rain_input + south_flood_bonus"

  south_evapotranspiration:
    from: south_moisture
    to: external
    rate: "base_evaporation * south_evap_mult * (1 + (south_dormant + south_active) / optimal_forage * 0.3)"

  south_deep_percolation:
    from: south_moisture
    to: external
    rate: "max(0, south_moisture - field_capacity) * 0.5"

  south_som_loss:
    from: south_som
    to: external
    rate: "south_som * som_mineralization_rate"

  south_manure:
    from: external
    to: south_som
    rate: "(south_grazing_active + south_grazing_dormant) * manure_addition_rate"

  # ============================================================
  # ROTATION TRACKING
  # ============================================================
  rotation_timer_increment:
    from: external
    to: rotation_timer
    rate: 1
